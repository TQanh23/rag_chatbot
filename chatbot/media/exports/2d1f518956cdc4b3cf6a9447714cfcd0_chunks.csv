chunk_id,document_id,order_index,page,end_page,section,text_len,text
2d1f518956cdc4b3cf6a9447714cfcd0:0,2d1f518956cdc4b3cf6a9447714cfcd0,0,1,,,143,Hệ Điều Hành (Nguyên lý các hệ điều hành) Đỗ Quốc Huy huydq@soict.hust.edu.vn Bộ môn Khoa Học Máy Tính Viện Công Nghệ Thông Tin và Truyền Thông
2d1f518956cdc4b3cf6a9447714cfcd0:1,2d1f518956cdc4b3cf6a9447714cfcd0,1,2,,,931,"l Bộ nhớ ngoài (đĩa từ, băng từ, đĩa quang,..): dung lượng lớn và cho phép lưu trữ lâu dài l Được người dùng sử dụng lưu trữ dữ liệu và chương trình l Dữ liệu và chương trình được lưu dưới dạng file (tập tin/tệp) ⇒ Tạo nên hệ thống file l Hệ thống file gồm 2 phần riêng biệt l Các file: Chứa dữ liệu/chương trình của hệ thống/người dùng l Cấu trúc thư mục : Cung cấp các thông tin về file l Hệ thống file lớn ⇒ Quản lý như thế nào? l Các thuộc tính của file, thao tác cần phải cung cấp? l Lưu trữ và truy xuất dữ liệu trên thiết bị lưu trữ như thế nào? l Phương pháp cung cấp không gian lưu trữ, quản lý vùng tự do ⇒Khó khăn phải trong suốt với người dùng (tính thuận tiện) l Các file dữ liệu /chương trình có thể sử dụng chung l Đảm bảo tính toàn vẹn dữ liệu và loại bỏ truy nhập bất hợp lệ? l Dữ liệu không lưu trữ tập trung ⇒ hệ thống file phân tán l Truy nhập file từ xa, đảm bảo tính toàn vẹn... Chương 4 Quản lý hệ thống file"
2d1f518956cdc4b3cf6a9447714cfcd0:2,2d1f518956cdc4b3cf6a9447714cfcd0,2,3,,,113,①Hệ thống file ②Cài đặt hệ thống file ③Tổ chức thông tin trên đĩa từ ④Hệ thống FAT Chương 4 Quản lý hệ thống file
2d1f518956cdc4b3cf6a9447714cfcd0:3,2d1f518956cdc4b3cf6a9447714cfcd0,3,4,,,101,lKhái niệm file lCấu trúc thư mục Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file
2d1f518956cdc4b3cf6a9447714cfcd0:4,2d1f518956cdc4b3cf6a9447714cfcd0,4,5,,,723,"Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Giới thiệu l Thông tin lưu trữ trên nhiều phương tiện/thiết bị lưu trữ khác nhau l Ví dụ: Đĩa từ, băng từ, đĩa quang... l Thiết bị lưu trữ được mô hình như một mảng của các khối nhớ l File là tập thông tin ghi trên thiết bị lưu trữ. l File là đơn vị lưu trữ của hệ điều hành trên bộ nhớ ngoài l File bao gồm dãy các bits, bytes, dòng, bản ghi,... mang ý nghĩa được định nghĩa bởi người tạo ra l Cấu trúc của file được định nghĩa theo loại file l File văn bản: Chuỗi ký tự tổ chức thành dòng l File đối tượng: Bytes được tổ chức thành khối để chương trình liên kết (linker) hiểu được l File thực thi: Chuỗi các mã lệnh có thể thực hiện trong bộ nhớ l . . ."
2d1f518956cdc4b3cf6a9447714cfcd0:5,2d1f518956cdc4b3cf6a9447714cfcd0,5,6,,,1053,"Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thuộc tính file l Tên file (Name): Chuỗi ký tự (hello.c) l Thông tin lưu dưới dạng người dùng có thể đọc được l Có thể phân biệt chữ hoa/chữ thường l Đảm bảo tính độc lập của file với tiến trình, người dùng... l A tạo file hello.c bằng notepad trên hệ Windows l B dùng emacs trên linux sửa lại file bởi xác định tên hello.c l Định danh (Identifier): Thẻ xác định duy nhất một file l Kiểu (Type): Dùng cho hệ thống hỗ trợ nhiều kiểu file l Có thể xác định kiểu file dựa trên một phần của tên file l Ví dụ: .exe, .com/ .doc, .txt/ .c, .jav, .pas/ .pdf, .jpg,... l Dựa trên kiểu, HĐH sẽ thao tác trên tập tin phù hợp l Thực hiện file thực thi mà file nguồn đã sửa ⇒ Dịch lại l Nháy đúp vào một file văn bản (*.doc)⇒ Gọi word processor l Vị trí (Position): Trỏ tới thiết bị và vị trí của file trên đó l Kích thước (Size): Kích thước hiện thời/ tối đa của file l Bảo vệ (Protection): Điều khiển truy nhập: Ai có thể đọc/ghi.. l Thời gian (Time): Thời điểm tạo, sửa đổi, sử dụng cuối ..."
2d1f518956cdc4b3cf6a9447714cfcd0:6,2d1f518956cdc4b3cf6a9447714cfcd0,6,7,,,570,Không gian lưu trữ hello.c vi trí hdh.pdf vi trí hello.c hdh.pdf Bản ghi file Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thuộc tính file (tiếp tục) l Thuộc tính file được lưu trong cấu trúc dữ liệu: Bản ghi file l Có thể chỉ chứa tên file và định danh file; định danh file xác định các thông tin còn lại l Kích thước từ vài bytes lên tới kilobytes l Các bản ghi file được lưu giữ trong Thư mục file l Kích thước có thể đạt tới Megabytes l Thường được lữu trữ trên thiết bị nhớ ngoài l Được đưa từng phần vào bộ nhớ khi cần thiết Thư mục file
2d1f518956cdc4b3cf6a9447714cfcd0:7,2d1f518956cdc4b3cf6a9447714cfcd0,7,8,,,233,Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản l Tạo file (Create) l Ghi file (Write) l Đọc file (Read) l Thay đổi vị trí trong file(Seek) l Xóa file (Delete) l Thu gọn file (Truncate) l . . .
2d1f518956cdc4b3cf6a9447714cfcd0:8,2d1f518956cdc4b3cf6a9447714cfcd0,8,9,,,387,"Thư mục file hello.c vi trí hello.c Create(SoNT.dat) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Tạo file l Tìm vùng tự do trong không gian lưu trữ của hệ thống file l Cung cấp vùng trống như thế nào? l Tạo một phần tử mới trong thư mục file Không gian lưu trữ l Lưu tên file, vị trí của file và các thông tin khác"
2d1f518956cdc4b3cf6a9447714cfcd0:9,2d1f518956cdc4b3cf6a9447714cfcd0,9,10,,,511,"Thư mục file hello.c vi trí hello.c Write(SoNT.dat, 17) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Ghi file l Lời gọi hệ thống Write() yêu cầu tên file và dữ liệu được ghi l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ ghi (write pointer) để chỉ ra vị trí ghi l Con trỏ ghi thay đổi sau mỗi thao tác ghi Không gian lưu trữ Kiemtra.pdf 235 17 wp"
2d1f518956cdc4b3cf6a9447714cfcd0:10,2d1f518956cdc4b3cf6a9447714cfcd0,10,11,,,534,"Thư mục file hello.c vi trí Write(SoNT.dat, 17) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Ghi file l Lời gọi hệ thống Write() yêu cầu tên file và dữ liệu được ghi l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ ghi (write pointer) để chỉ ra vị trí ghi l Con trỏ ghi thay đổi sau mỗi thao tác ghi Không gian lưu trữ Kiemtra.pdf 235 17 wp Write(SoNT.dat, 19) 19 hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:11,2d1f518956cdc4b3cf6a9447714cfcd0,11,12,,,557,"Thư mục file hello.c vi trí Write(SoNT.dat, 17) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Ghi file l Lời gọi hệ thống Write() yêu cầu tên file và dữ liệu được ghi l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ ghi (write pointer) để chỉ ra vị trí ghi l Con trỏ ghi thay đổi sau mỗi thao tác ghi Không gian lưu trữ Kiemtra.pdf 235 17 wp Write(SoNT.dat, 19) 19 Write(SoNT.dat, 23) 23 hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:12,2d1f518956cdc4b3cf6a9447714cfcd0,12,13,,,580,"Thư mục file hello.c vi trí Write(SoNT.dat, 17) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Ghi file l Lời gọi hệ thống Write() yêu cầu tên file và dữ liệu được ghi l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ ghi (write pointer) để chỉ ra vị trí ghi l Con trỏ ghi thay đổi sau mỗi thao tác ghi Không gian lưu trữ Kiemtra.pdf 235 17 wp Write(SoNT.dat, 19) 19 Write(SoNT.dat, 23) 23 Write(SoNT.dat, 29) 29 hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:13,2d1f518956cdc4b3cf6a9447714cfcd0,13,14,,,534,"Thư mục file hello.c vi trí Buf =Read(SoNT.dat) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Đọc file l Lời gọi hệ thống Read() yêu cầu tên file và vùng đệm ghi KQ l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ đọc (read pointer) chỉ ra vị trí được đọc l Con trỏ đọc thay đổi sau mỗi thao tác đọc dữ liệu Không gian lưu trữ Kiemtra.pdf 235 17 rp 19 23 29 Buf:17 hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:14,2d1f518956cdc4b3cf6a9447714cfcd0,14,15,,,534,"Thư mục file hello.c vi trí Buf =Read(SoNT.dat) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Đọc file l Lời gọi hệ thống Read() yêu cầu tên file và vùng đệm ghi KQ l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ đọc (read pointer) chỉ ra vị trí được đọc l Con trỏ đọc thay đổi sau mỗi thao tác đọc dữ liệu Không gian lưu trữ Kiemtra.pdf 235 17 rp 19 23 29 Buf:19 hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:15,2d1f518956cdc4b3cf6a9447714cfcd0,15,16,,,534,"Thư mục file hello.c vi trí Buf =Read(SoNT.dat) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Đọc file l Lời gọi hệ thống Read() yêu cầu tên file và vùng đệm ghi KQ l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ đọc (read pointer) chỉ ra vị trí được đọc l Con trỏ đọc thay đổi sau mỗi thao tác đọc dữ liệu Không gian lưu trữ Kiemtra.pdf 235 17 rp 19 23 29 Buf:23 hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:16,2d1f518956cdc4b3cf6a9447714cfcd0,16,17,,,594,"Thư mục file hello.c vi trí Buf =Read(SoNT.dat) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Đọc file l Lời gọi hệ thống Read() yêu cầu tên file và vùng đệm ghi KQ l Dùng tên file, tìm kiếm file trong thư mục file l Dựa vào trường vị trí, tìm vị trí của file trên thiết bị lưu trữ l Hệ thống lưu con trỏ đọc (read pointer) chỉ ra vị trí được đọc l Con trỏ đọc thay đổi sau mỗi thao tác đọc dữ liệu Không gian lưu trữ Kiemtra.pdf 235 17 rp 19 23 29 Buf:29 l Dùng một con trỏ cho cả thao tác đọc và ghi: con trỏ file hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:17,2d1f518956cdc4b3cf6a9447714cfcd0,17,18,,,458,"Thư mục file hello.c vi trí Delete(SoNT.dat) SoNT.dat vi trí 19/04/2011 Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Xóa file l Dùng tên file, tìm kiếm file trong thư mục file l Vùng nhớ được xác định bởi 2 trường vị trí và kích thước được giải phóng để có thể sử dụng lại bởi các file khác l Xóa phần tử tương ứng trong thư mục file l Xóa logic / xóa vật lý Không gian lưu trữ Kiemtra.pdf 235 17 19 23 29 hello.c"
2d1f518956cdc4b3cf6a9447714cfcd0:18,2d1f518956cdc4b3cf6a9447714cfcd0,18,19,,,505,Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Thay đổi vị trí trong file và thu gọn file l Thay đổi vị trí trong file l Duyệt thư mục để tìm phần tử tương ứng l Con trỏ file được thay bằng giá trị thích hợp l Thao tác này không yêu cầu một hoạt động vào/ra l Thu gọn file l Được sử dụng khi người sử dụng muốn xóa nội dung file nhưng vẫn giữ nguyên các thuộc tính l Tìm kiếm file trong thư mục file l Đặt kích thước file về 0 l Giải phóng vùng nhớ dành cho file
2d1f518956cdc4b3cf6a9447714cfcd0:19,2d1f518956cdc4b3cf6a9447714cfcd0,19,20,,,387,"Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản : Một số thao tác khác l Ngoài các thao tác cơ bản, còn tồn tại nhiều thao tác khác l Thêm dữ liệu vào cuối file (append) l Lấy/đặt thông tin thuộc tính file l Đổi tên file l Có thể được đảm bảo thông qua các thao tác cơ bản. Ví dụ copy file l Tạo file mới l Đọc dữ liệu từ file cũ l Ghi ra file mới"
2d1f518956cdc4b3cf6a9447714cfcd0:20,2d1f518956cdc4b3cf6a9447714cfcd0,20,21,,,956,"Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.1 Khái niệm file Các thao tác cơ bản: Đóng mở file l Các thao tác file phải duyệt thư mục file ⇒ Lãng phí thời gian l Để giải quyết, các tiến trình phải thực hiện mở file (open) trước khi thao tác với file l Thao tác mở file: tìm kiếm file trong thư mục file l Chép phần tử tương ứng vào bảng file mở l Chứa thông tin về các file đang được mở l Trả lại con trỏ của phần tử tương ứng trong bản file mở l Khi có yêu cầu, HĐH tìm kiếm trong bảng file mở l Dùng con trỏ trả về của thao tác mở file l Khi không sử dụng file nữa cần phải đóng (close) file. l HĐH sẽ loại bỏ phần tử tương ứng trong bảng file mở l Thao tác đóng/mỏ file trong môi trường đa người dùng l Dùng 2 loại bảng file mở: Cho từng tiến trình và cho hệ thống l Ghi lại số tiến trình đang mở file (File Open Counter) l Tăng/Giảm bộ đếm khi có tiến trình mở/đóng file l Xóa p/tử tương ứng trong bảng file mở mức hệ thống khi bộ đếm bằng không"
2d1f518956cdc4b3cf6a9447714cfcd0:21,2d1f518956cdc4b3cf6a9447714cfcd0,21,22,,,103,lKhái niệm file lCấu trúc thư mục Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục
2d1f518956cdc4b3cf6a9447714cfcd0:22,2d1f518956cdc4b3cf6a9447714cfcd0,22,23,,,246,"Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục Các phân vùng (Partition) l Đĩa được chia thành nhiều phân vùng Partitions, Minidisks, Volumes l Mỗi phân vùng được xử lý như vùng lưu trữ phân biệt l Có thể chứa một HĐH riêng"
2d1f518956cdc4b3cf6a9447714cfcd0:23,2d1f518956cdc4b3cf6a9447714cfcd0,23,24,,,273,Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục Các phân vùng (Partition) Kết hợp một vài đĩa thành một cấu trúc logic lớn l Người dùng chỉ quan tâm tới cấu trúc file và thư mục logic l Không quan tâm tới cách phân phối vật lý không gian đĩa cho files
2d1f518956cdc4b3cf6a9447714cfcd0:24,2d1f518956cdc4b3cf6a9447714cfcd0,24,25,,,870,"Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục Các thao tác với thư mục l Mỗi một phân khu lưu các thông tin về file trong nó l Các thông tin file được lưu trữ trong thư mục thiết bị - thư mục l Thư mục là bảng chuyển cho phép ánh xạ từ một tên (file) thành một phần tử trong thư mục l Thư mục có thể được cài đặt bằng nhiều cách khác nhau l Yêu cầu các thao tác chèn, tạo mới, xóa, duyệt danh sách l Các thao tác l Tìm kiếm file: Tìm phần tử ứng với một file xác định l Tạo file: Tạo file mới cần tạo phần tử trong thư mục l Xóa file: Khi xóa file, xóa phần tử tương ứng trong thư mục l Liệt kê thư mục: Liệt kê files và nội dung phần tử tương ứng trong thư mục l Đổi tên file: Thay đổi tên file, vị trí trong cấu trúc thư mục l Duyệt hệ thống file: Truy nhập tất cả thư mục và nội dung tất cả các files trong thư mục (backup dữ liệu lên băng từ)"
2d1f518956cdc4b3cf6a9447714cfcd0:25,2d1f518956cdc4b3cf6a9447714cfcd0,25,26,,,242,"Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục Thư mục một mức l Cấu trúc đơn giản nhất, các file nằm trong cùng một thư mục l Số người dùng và số file lớn, khả năng trùng tên file cao l Mỗi người dùng một thư mục riêng"
2d1f518956cdc4b3cf6a9447714cfcd0:26,2d1f518956cdc4b3cf6a9447714cfcd0,26,27,,,467,"Thư mục một mức Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục l Mỗi người sử dụng có một thư mục riêng, khi làm việc với file chỉ duyệt thư mục riêng l Khi log in, hệ thống sẽ kiểm tra và cho phép người sử dụng làm việc với thư mục riêng l Khi thêm một người dùng l Hệ thống tạo phần tử mới trong Master file directory l Tạo ra User file directory l Giả quyết v/đề trùng tên; Hiệu quả khi người dùng độc lập l Khó khăn khi muốn dùng chung file"
2d1f518956cdc4b3cf6a9447714cfcd0:27,2d1f518956cdc4b3cf6a9447714cfcd0,27,28,,,315,Thư mục cấu trúc cây Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục l Tồn tại một đường dẫn (tương đối/tuyệt đối) đến một file l Thư mục con là file được xử lý đặc biệt (bit đánh dấu) l Các thao tác tạo/xóa/duyệt... t/hiện trên thư mục hiện thời l Xóa thư mục con ⇒ Xóa hết các cây con của nó
2d1f518956cdc4b3cf6a9447714cfcd0:28,2d1f518956cdc4b3cf6a9447714cfcd0,28,29,,,266,Thư mục dùng chung Chương 4: Quản lý hệ thống file 1. Hệ thống file 1.2 Cấu trúc thư mục l Người dùng có thể link đến một file của người dùng khác l Khi duyệt thư mục (backup) file có thể duyệt nhiều lần l Xóa file: liên kết/ nội dung (người tạo file /liên kết cuối)
2d1f518956cdc4b3cf6a9447714cfcd0:29,2d1f518956cdc4b3cf6a9447714cfcd0,29,30,,,113,①Hệ thống file ②Cài đặt hệ thống file ③Tổ chức thông tin trên đĩa từ ④Hệ thống FAT Chương 4 Quản lý hệ thống file
2d1f518956cdc4b3cf6a9447714cfcd0:30,2d1f518956cdc4b3cf6a9447714cfcd0,30,31,,,161,lCài đặt thư mục lCác phương pháp phân phối vùng lưu trữ lQuản lý vùng lưu trữ tự do Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2.1 Cài đặt thư mục
2d1f518956cdc4b3cf6a9447714cfcd0:31,2d1f518956cdc4b3cf6a9447714cfcd0,31,32,,,551,Phương pháp Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2.1 Cài đặt thư mục ① Danh sách tuyến tính với con trỏ tới các khối dữ liệu l Đơn giản cho lập trình l Tốn thời gian khi thực hiện các thao tác với thư mục l Phải duyệt toàn bộ danh sách ⇐ Dùng cây nhị phân? ② Bảng băm - Bảng băm với danh sách tuyến tính l Giảm thời gian duyệt thư mục l Đòi hỏi có một hàm băm hiệu quả l Vấn đề đụng độ ← hàm băm trả về cùng một kết quả với 2 tên file khác nhau l Vấn đề kích thước cố định → Tăng kích thước phải tính toán lại những phần đã tồn tại
2d1f518956cdc4b3cf6a9447714cfcd0:32,2d1f518956cdc4b3cf6a9447714cfcd0,32,33,,,97,Danh sách tuyến tính Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2.1 Cài đặt thư mục
2d1f518956cdc4b3cf6a9447714cfcd0:33,2d1f518956cdc4b3cf6a9447714cfcd0,33,34,,,85,Bảng băm Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2.1 Cài đặt thư mục
2d1f518956cdc4b3cf6a9447714cfcd0:34,2d1f518956cdc4b3cf6a9447714cfcd0,34,35,,,85,Bảng băm Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2.1 Cài đặt thư mục
2d1f518956cdc4b3cf6a9447714cfcd0:35,2d1f518956cdc4b3cf6a9447714cfcd0,35,36,,,161,lCài đặt thư mục lCác phương pháp phân phối vùng lưu trữ lQuản lý vùng lưu trữ tự do Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2.1 Cài đặt thư mục
2d1f518956cdc4b3cf6a9447714cfcd0:36,2d1f518956cdc4b3cf6a9447714cfcd0,36,37,,,367,Mục đích l Tăng hiệu năng truy nhập tuần tự l Dễ dàng truy nhập ngẫu nhiên tới file l Dễ dàng quản lý file Phương pháp l Phân phối liên tục (Continuous Allocation) l Phân phối liên kết (Linked List Allocation) l Phân phối chỉ mục (Indexed Allocation) Các phương pháp Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ
2d1f518956cdc4b3cf6a9447714cfcd0:37,2d1f518956cdc4b3cf6a9447714cfcd0,37,38,,,179,Phân phối liên tục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ liên tiếp nhau
2d1f518956cdc4b3cf6a9447714cfcd0:38,2d1f518956cdc4b3cf6a9447714cfcd0,38,39,,,179,Phân phối liên tục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ liên tiếp nhau
2d1f518956cdc4b3cf6a9447714cfcd0:39,2d1f518956cdc4b3cf6a9447714cfcd0,39,40,,,179,Phân phối liên tục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ liên tiếp nhau
2d1f518956cdc4b3cf6a9447714cfcd0:40,2d1f518956cdc4b3cf6a9447714cfcd0,40,41,,,179,Phân phối liên tục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ liên tiếp nhau
2d1f518956cdc4b3cf6a9447714cfcd0:41,2d1f518956cdc4b3cf6a9447714cfcd0,41,42,,,588,"Phân phối liên tục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ l File có độ dài n và bắt đầu ở khối b sẽ chiếm các khối b, b + 1, . . . , b + n − 1 l Hai khối b và b + 1 liên tiếp nhau ⇒ Không phải dịch chuyển đầu từ khi đọc (trừ sector cuối) ⇒ Tốc độ truy nhập nhanh l Cho phép truy nhập trực tiếp khối i của file ⇒ truy nhập khối b + i − 1 trên thiết bị lưu trữ l Lựa chọn vùng trống khi có yêu cầu lưu trữ? l Các chiến lược First-Fit /Worst Fit /Best Fit l Hiện tượng phân đoạn ngoài l Khó khăn khi muốn tăng kích thước của file"
2d1f518956cdc4b3cf6a9447714cfcd0:42,2d1f518956cdc4b3cf6a9447714cfcd0,42,43,,,229,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ không liên tục. Cuối mỗi khối là con trỏ, trỏ tới khối tiếp theo"
2d1f518956cdc4b3cf6a9447714cfcd0:43,2d1f518956cdc4b3cf6a9447714cfcd0,43,44,,,229,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ không liên tục. Cuối mỗi khối là con trỏ, trỏ tới khối tiếp theo"
2d1f518956cdc4b3cf6a9447714cfcd0:44,2d1f518956cdc4b3cf6a9447714cfcd0,44,45,,,229,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ không liên tục. Cuối mỗi khối là con trỏ, trỏ tới khối tiếp theo"
2d1f518956cdc4b3cf6a9447714cfcd0:45,2d1f518956cdc4b3cf6a9447714cfcd0,45,46,,,229,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ không liên tục. Cuối mỗi khối là con trỏ, trỏ tới khối tiếp theo"
2d1f518956cdc4b3cf6a9447714cfcd0:46,2d1f518956cdc4b3cf6a9447714cfcd0,46,47,,,229,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ không liên tục. Cuối mỗi khối là con trỏ, trỏ tới khối tiếp theo"
2d1f518956cdc4b3cf6a9447714cfcd0:47,2d1f518956cdc4b3cf6a9447714cfcd0,47,48,,,229,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ không liên tục. Cuối mỗi khối là con trỏ, trỏ tới khối tiếp theo"
2d1f518956cdc4b3cf6a9447714cfcd0:48,2d1f518956cdc4b3cf6a9447714cfcd0,48,49,,,265,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: File được phân phối các khối nhớ không liên tục. Cuối mỗi khối là con trỏ, trỏ tới khối tiếp theo File def gồm 5 khối: 5, 6, 8, 9, 11"
2d1f518956cdc4b3cf6a9447714cfcd0:49,2d1f518956cdc4b3cf6a9447714cfcd0,49,50,,,872,"Phân phối liên kết Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ l Chỉ áp dụng hiệu quả cho các file truy nhập tuần tự l Để truy nhập khối thứ n, phải duyệt qua n − 1 khối trước đó l Các khối không liên tục, phải định vị lại đầu từ l Tốc độ truy nhập chậm l Các khối trong file được liên kết bởi con trỏ. Nếu con trỏ lỗi? l Bị mất dư liệu do mất liên kết tới khối l Liên kết tới khối không có dữ liệu hoặc khối của file khác l Giải quyết: Sử dụng nhiều con trỏ trong mỗi khối ⇒Tốn nhớ l Áp dụng: FAT l Được sử dụng như danh sách liên kết l Gồm nhiều phần tử, mỗi phần tử ứng với một khối l Mỗi phần tử trong FAT, chứa khối tiếp theo của file l Khối cuối cùng có giá trị đặc biệt (FFFF) l Khối bị hỏng có giá trị (FFF7) l Khối chưa sử dụng có giá trị (0) l Trường vị trí trong bản ghi file, chứa khối đầu tiên của file"
2d1f518956cdc4b3cf6a9447714cfcd0:50,2d1f518956cdc4b3cf6a9447714cfcd0,50,51,,,220,Phân phối chỉ mục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: Mỗi file có một khối chỉ mục chính (index block) chứa danh sách các khối dữ liệu của file
2d1f518956cdc4b3cf6a9447714cfcd0:51,2d1f518956cdc4b3cf6a9447714cfcd0,51,52,,,220,Phân phối chỉ mục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: Mỗi file có một khối chỉ mục chính (index block) chứa danh sách các khối dữ liệu của file
2d1f518956cdc4b3cf6a9447714cfcd0:52,2d1f518956cdc4b3cf6a9447714cfcd0,52,53,,,220,Phân phối chỉ mục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: Mỗi file có một khối chỉ mục chính (index block) chứa danh sách các khối dữ liệu của file
2d1f518956cdc4b3cf6a9447714cfcd0:53,2d1f518956cdc4b3cf6a9447714cfcd0,53,54,,,220,Phân phối chỉ mục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: Mỗi file có một khối chỉ mục chính (index block) chứa danh sách các khối dữ liệu của file
2d1f518956cdc4b3cf6a9447714cfcd0:54,2d1f518956cdc4b3cf6a9447714cfcd0,54,55,,,220,Phân phối chỉ mục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: Mỗi file có một khối chỉ mục chính (index block) chứa danh sách các khối dữ liệu của file
2d1f518956cdc4b3cf6a9447714cfcd0:55,2d1f518956cdc4b3cf6a9447714cfcd0,55,56,,,220,Phân phối chỉ mục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ Nguyên tắc: Mỗi file có một khối chỉ mục chính (index block) chứa danh sách các khối dữ liệu của file
2d1f518956cdc4b3cf6a9447714cfcd0:56,2d1f518956cdc4b3cf6a9447714cfcd0,56,57,,,850,"Phân phối chỉ mục Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ l Phần tử thứ i của khối chỉ mục trỏ tới khối thứ i của file l Đọc khối i dùng con trỏ được khi tại p/tử i của khối chỉ mục l Tạo file, các phần tử của khối chỉ mục có giá trị null (-1) l Cần thêm khối i, địa chỉ khối được cấp, được đưa vào p/tử i l Nhận xét l Không gây hiện tượng phân đoạn ngoài l Cho phép truy nhập trực tiếp l Cần khối chỉ mục: file có k/thước nhỏ, vẫn cần 2 khối l Khối cho dữ liệu l Khối chi khối chỉ mục (chỉ dùng 1 phần tử) Giải quyết: Giảm kích thước khối ⇒ Giảm phí tổn bộ nhớ ⇒ Vấn đề về kích thước file có thể lưu trữ. l Sơ đồ liên kết l Liên kết các khối chỉ mục lại l P/tử cuối của khối chỉ mục trỏ tới khối chỉ mục khác nếu cần l Index nhiều mức l Dùng một khối chỉ mục trỏ tới các khối chỉ mục khác"
2d1f518956cdc4b3cf6a9447714cfcd0:57,2d1f518956cdc4b3cf6a9447714cfcd0,57,58,,,335,Sơ đồ kết hợp (UNIX) Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ l 12 direct block trỏ tới data block l Single indirect block chứa địa chỉ khối direct block l Double indirect block chứa địa chỉ khối Single indirect block l Triple indirect block chứa địa chỉ khối Double indirect
2d1f518956cdc4b3cf6a9447714cfcd0:58,2d1f518956cdc4b3cf6a9447714cfcd0,58,59,,,172,lCài đặt thư mục lCác phương pháp phân phối vùng lưu trữ lQuản lý vùng lưu trữ tự do Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2.3 Quản lý vùng lưu trữ tự do
2d1f518956cdc4b3cf6a9447714cfcd0:59,2d1f518956cdc4b3cf6a9447714cfcd0,59,60,,,836,"Phương pháp Chương 4: Quản lý hệ thống file 2. Cài đặt hệ thống file 2. 2 Các phương pháp phân phối vùng lưu trữ l Bit vector l Mỗi block thể hiện bởi 1 bit (1: free; 0: allocated) l Dễ dàng tìm ra n khối nhớ liên tục l Cần có lệnh cho phép làm việc với bit l Danh sách liên kết (link list) l Lưu giữ con trỏ tới khối đĩa trống đầu tiên l Khối nhớ này chứa con trỏ trở tới khối đĩa trống tiếp theo l Không hiệu quả khi duyệt danh sách l Nhóm (Grouping) l Lưu trữ địa chỉ n khối tự do trong khối tự do đầu tiên l n − 1 khối đầu tự do, khối n chứa đ/chỉ của n khối tự do tiếp l Ưu điểm: Tìm vùng nhớ tự do nhanh chóng l Bộ đếm (Counting) l Do các khối nhớ liên tục được c/cấp và g/phóng đồng thời l Nguyên tắc: Lưu địa chỉ khối nhớ tự do đầu tiên và kích thước vùng nhớ liên tục trong DS quản lý vùng trống l Hiệu quả khi bộ đếm lớn hơn 1"
2d1f518956cdc4b3cf6a9447714cfcd0:60,2d1f518956cdc4b3cf6a9447714cfcd0,60,61,,,113,①Hệ thống file ②Cài đặt hệ thống file ③Tổ chức thông tin trên đĩa từ ④Hệ thống FAT Chương 4 Quản lý hệ thống file
2d1f518956cdc4b3cf6a9447714cfcd0:61,2d1f518956cdc4b3cf6a9447714cfcd0,61,62,,,141,lCấu trúc vật lý của đĩa lCấu trúc logic của đĩa Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa
2d1f518956cdc4b3cf6a9447714cfcd0:62,2d1f518956cdc4b3cf6a9447714cfcd0,62,63,,,115,"44 / 107 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Đĩa mềm 5 ! """
2d1f518956cdc4b3cf6a9447714cfcd0:63,2d1f518956cdc4b3cf6a9447714cfcd0,63,64,,,115,45 / 107 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Đĩa mềm 3 ! #
2d1f518956cdc4b3cf6a9447714cfcd0:64,2d1f518956cdc4b3cf6a9447714cfcd0,64,65,,,355,"Mặt 0 Rãnh Sector Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Cấu trúc vật lý đĩa mềm l Rãnh đĩa (Track): Các vòng tròn đồng tâm l Được đánh số 0, 1,. . . từ ngoài vào trong l Mặt đĩa. Mỗi mặt đĩa được đọc bởi một đầu đọc (Header) l Các đầu từ được đánh số 0, 1 l Cung từ (Sector) l Được đánh số 1, 2,. . ."
2d1f518956cdc4b3cf6a9447714cfcd0:65,2d1f518956cdc4b3cf6a9447714cfcd0,65,66,,,400,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa"
2d1f518956cdc4b3cf6a9447714cfcd0:66,2d1f518956cdc4b3cf6a9447714cfcd0,66,67,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 1 >→ #0"
2d1f518956cdc4b3cf6a9447714cfcd0:67,2d1f518956cdc4b3cf6a9447714cfcd0,67,68,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 2 >→ #1"
2d1f518956cdc4b3cf6a9447714cfcd0:68,2d1f518956cdc4b3cf6a9447714cfcd0,68,69,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 3 >→ #2"
2d1f518956cdc4b3cf6a9447714cfcd0:69,2d1f518956cdc4b3cf6a9447714cfcd0,69,70,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 4 >→ #3"
2d1f518956cdc4b3cf6a9447714cfcd0:70,2d1f518956cdc4b3cf6a9447714cfcd0,70,71,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 5 >→ #4"
2d1f518956cdc4b3cf6a9447714cfcd0:71,2d1f518956cdc4b3cf6a9447714cfcd0,71,72,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 6 >→ #5"
2d1f518956cdc4b3cf6a9447714cfcd0:72,2d1f518956cdc4b3cf6a9447714cfcd0,72,73,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 7 >→ #6"
2d1f518956cdc4b3cf6a9447714cfcd0:73,2d1f518956cdc4b3cf6a9447714cfcd0,73,74,,,423,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 0, 8 >→ #7"
2d1f518956cdc4b3cf6a9447714cfcd0:74,2d1f518956cdc4b3cf6a9447714cfcd0,74,75,,,421,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 1, 0,1>→ #8"
2d1f518956cdc4b3cf6a9447714cfcd0:75,2d1f518956cdc4b3cf6a9447714cfcd0,75,76,,,421,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 1, 0,2>→ #9"
2d1f518956cdc4b3cf6a9447714cfcd0:76,2d1f518956cdc4b3cf6a9447714cfcd0,76,77,,,422,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 1, 0,3>→ #10"
2d1f518956cdc4b3cf6a9447714cfcd0:77,2d1f518956cdc4b3cf6a9447714cfcd0,77,78,,,422,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 1, 0,8>→ #15"
2d1f518956cdc4b3cf6a9447714cfcd0:78,2d1f518956cdc4b3cf6a9447714cfcd0,78,79,,,422,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa Sector < 0, 1,1>→ #16"
2d1f518956cdc4b3cf6a9447714cfcd0:79,2d1f518956cdc4b3cf6a9447714cfcd0,79,80,,,487,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Định vị thông tin trên đĩa mềm l Sector đơn vị thông tin hệ thống dùng làm việc với đĩa l Sector xác định qua tọa độ 3 chiều: Header, Track, Sector l Ví dụ: Boot Sector của đĩa mềm: Sector <0, 0, 1> l Sector được xác định qua số hiệu sector (tọa độ 1 chiều) l Vị trí tương đối so với sector đầu tiên của đĩa #0 #1 #2 <0,0,1> <0,0,2> <0,0,3> #8 #9 <1,0,1> <1,0,2> Mô hình thiết bị lưu trữ (Disk)"
2d1f518956cdc4b3cf6a9447714cfcd0:80,2d1f518956cdc4b3cf6a9447714cfcd0,80,81,,,101,Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Đĩa cứng
2d1f518956cdc4b3cf6a9447714cfcd0:81,2d1f518956cdc4b3cf6a9447714cfcd0,81,82,,,110,49 / 107 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Đĩa cứng
2d1f518956cdc4b3cf6a9447714cfcd0:82,2d1f518956cdc4b3cf6a9447714cfcd0,82,83,,,433,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Cấu trúc vật lý đĩa cứng Cấu trúc l Gồm nhiều mặt đĩa, được đánh số từ 0,1 l Các rãnh cùng bán kính tạo nên cylinder, được đánh số từ 0, 1,.. l Các sector trên mỗi mặt của mỗi cylinder, được đánh số từ 1,2,... Định vị thông tin l Tọa độ 3 chiều (H, C, S) l Tọa độ 1 chiều: Số hiệu sector l Nguyên tắc như với đĩa mềm: Sector→Header→Cylinder"
2d1f518956cdc4b3cf6a9447714cfcd0:83,2d1f518956cdc4b3cf6a9447714cfcd0,83,84,,,586,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Truy nhập sector trên đĩa l Sector: đơn vị thông tin máy tính dùng để làm việc với đĩa từ l Có thể truy nhập (đọc/ghi/format/...) tới từng sector l Truy nhập sử dụng ngắt BIOS 13h (chức năng 2, 3, 5,...) l Không phụ thuộc hệ điều hành l Sector được xác định theo địa chỉ <H,C,S> l Truy nhập sử dụng lời gọi hệ thống l Ngắt của hệ điều hành l Ví dụ: MSDOS cung cấp ngắt 25h/26h cho phép đọc/ghi các sector theo địa chỉ tuyến tính l Sử dụng hàm WIN32 API l CreateFile()/ReadFile()/WriteFile()..."
2d1f518956cdc4b3cf6a9447714cfcd0:84,2d1f518956cdc4b3cf6a9447714cfcd0,84,85,,,667,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Sử dụng ngắt 13h Thanh ghi Ý nghĩa AH 2h:Đọc sector; 3h: Ghi Sector AL Số sector cần đọc Các sector phải trên cùng một mặt, một rãnh DH Số hiệu mặt đĩa DL Số hiệu ổ đĩa. 0h:A; 80h: Đĩa cứng thứ nhất; 81h Đĩa cứng thứ 2 CH Số hiệu Track/Cylinder (Sử dụng 10 bit, trong đó lấy 2 bit cao của CL) CL Số hiệu sector (chỉ sử dụng 6 bit thấp) ES:BX Trỏ tới vùng đệm, nơi sẽ chứa dữ liệu đọc đươc (khi AH=2h) hoặc dữ liệu ghi ra đĩa (Khi AH=3h) CarryFlag CF=0 không có lỗi; CL chứa số sector đọc được CF=1 Có lỗi, AH chứa mã lỗi WinXP hạn chế sử dụng ngắt 13h để truy nhập trực tiếp"
2d1f518956cdc4b3cf6a9447714cfcd0:85,2d1f518956cdc4b3cf6a9447714cfcd0,85,86,,,488,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Sử dụng ngắt 13h (Ví dụ) #include <stdio.h> #include <dos.h> int main(int argc, char *argv[]){ union REGS regs; struct SREGS sregs; int Buf[512]; int i; regs.h.ah = 0x02; regs.h.al = 0x01; regs.h.dh = 0x00; regs.h.dl = 0x80; regs.h.ch = 0x00; regs.h.cl = 0x01; regs.x.bx = FP_OFF(Buf); sregs.es = FP_SEG(Buf); int86x(0x13,&regs,&regs,&sregs); for(i=0;i<512;i++) printf(""%4X"",Buf[i]); return 0; }"
2d1f518956cdc4b3cf6a9447714cfcd0:86,2d1f518956cdc4b3cf6a9447714cfcd0,86,87,,,848,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Sử dụng WIN32 API l HANDLE CreateFile(. . .): Mở file/thiết bị vào ra l LPCTSTR lpFileName, ⇒ Tên file/thiết bị vào ra l ” ""\\?\\\\\.\\C : ” Phân vùng / Ổ đĩa C l ”\\\\.\\PhysicalDrive0” Ổ đĩa cứng thứ nhất l DWORD dwDesiredAccess,⇒ Thao tác với thiết bị l DWORD dwShareMode,⇒ Cho phép dùng chung l LPSECURITY_ATTRIBUTES lpSecurityAttributes (NULL), l DWORD dwCreationDisposition,⇒ Hành động thực hiện l DWORD dwFlagsAndAttributes, ⇒ Thuộc tính l HANDLE hTemplateFile (NULL) l BOOL ReadFile(. . .) l HANDLE hFile,⇒File muốn đọc l LPVOID lpBuffer, ⇒ Vùng đệm chứa dữ liệu l DWORD nNumberOfBytesToRead,⇒, số byte cần đọc l LPDWORD lpNumberOfBytesRead,⇒ số byte đọc được l LPOVERLAPPED lpOverlapped (NULL) l BOOL WriteFile(. . .) ⇒Tham số tương tự ReadFile()"
2d1f518956cdc4b3cf6a9447714cfcd0:87,2d1f518956cdc4b3cf6a9447714cfcd0,87,88,,,537,"#include <windows.h> #include <stdio.h> int main(int argc, char *argv[]){ HANDLE hDisk; BYTE Buf[512]; int byteread,i; hDisk=CreateFile(""\\\\.\\PhysicalDrive0"",GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING,0,NULL); i f (hDisk==INVALID_HANDLE_VALUE) printf(""Loi thiet bi""); else { ReadFile(hDisk,Buf,512,&byteread,NULL); for(i=0;i<512;i++) printf(""%4X"",Buf[i]); CloseHandle(hDisk); } return 0; } Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Sử dụng WIN32 API (Ví dụ)"
2d1f518956cdc4b3cf6a9447714cfcd0:88,2d1f518956cdc4b3cf6a9447714cfcd0,88,89,,,110,Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.1 Cấu trúc vật lý của đĩa Kết quả thực hiện
2d1f518956cdc4b3cf6a9447714cfcd0:89,2d1f518956cdc4b3cf6a9447714cfcd0,89,90,,,141,lCấu trúc vật lý của đĩa lCấu trúc logic của đĩa Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3. 2.Cấu trúc logic của đĩa
2d1f518956cdc4b3cf6a9447714cfcd0:90,2d1f518956cdc4b3cf6a9447714cfcd0,90,91,,,683,"MBR Sector ẩn Phân vùng1 Phân vùng2 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Cấu trúc logic l Đĩa mềm: Mỗi hệ điều hành có một chiến lược quản lý riêng l Đĩa cứng (Có dung lượng lớn) l Được chia thành nhiều phân vùng (Partitions, Volumes,..) l Mỗi vùng là tập hợp các Cylinder liên tiếp nhau l Người dùng ấn định kích thước (Ví dụ dùng: fdisk) l Mỗi phân vùng có thể được quản lý bởi một HĐH riêng l HĐH format phân vùng theo định dạng được sử dụng l Tồn tại nhiều hệ thống khác nhau: FAT, NTFS, EXT3,... l Trước tất cả các phân vùng là các sector bị che l Master Boot Record (MBR): Sector đầu tiên của đĩa Sector ẩn với phân vùng 2"
2d1f518956cdc4b3cf6a9447714cfcd0:91,2d1f518956cdc4b3cf6a9447714cfcd0,91,92,,,576,"Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Master Boor Record 1. Chương trình nhận biết l Đọc bảng phân chương để biết l Vị trí các phân vùng l Phân vùng tích cực (chứa HĐH) l Đọc và thực hiện sector đầu tiên của phân vùng tích cực 2. Bảng phân chương (64bytes) l Gồm 4 phần tử, mỗi phần tử 16 bytes l Mỗi phần tử chứa thông tin một vùng Vị trí, kích thước, hệ thống chiếm giữ 3. Chữ ký hệ thống (luôn là 55AA) l Sector quan trọng nhất của đĩa l Sector đầu tiên trên đĩa (Số hiệu 0 hoặc địa chỉ <0, 0, 1>) l Cấu trúc gồm 3 phần"
2d1f518956cdc4b3cf6a9447714cfcd0:92,2d1f518956cdc4b3cf6a9447714cfcd0,92,93,,,600,"Stt Ofs Size Ý nghĩa 1 0 1B Phân vùng tích cực? 80h nếu đúng; 0: Data Địa chỉ đầu 2 1 1B Số hiệu mặt đĩa đầu của phân vùng 3 2 1W Số hiêu sector và cylinder đầu của phân vùng 4 4 1B Mã nhận diện hệ thốn. 05/0F: Partition mởrộng 06:Big Dos; 07:NTFS; 0B: FAT32,.. đ/c cuối 5 5 1B Số hiệu đầu đọc cuối 6 6 1W Số hiệu sector và cylinder cuối của phân vùng. (Số hiệu sector chỉ dùng 6 bit thấp) 7 8 1DW Đia chỉ đầu, tính theo số hiệu sector 8 12 1DW Số sector trong phân vùng Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Cấu trúc một phần tử bảng phân chương"
2d1f518956cdc4b3cf6a9447714cfcd0:93,2d1f518956cdc4b3cf6a9447714cfcd0,93,94,,,503,00 01 01 00 07 FE 3F F8 3F 00 00 00 7A 09 3D 00 80 00 01 F9 0B FE BF 30 B9 09 3D 00 38 7B 4C 00 00 00 81 EB 0F FE FF FF 2B 1D B7 00 72 13 7A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 55 AA Giải mã Boot Vi trí đầu Vi trí cuối #sector Số sector Hdr Cyl Sec HdR Cyl Sec No 1 0 1 254 248 63 63 4000122 Yes 0 249 1 254 560 63 4000185 5012280 No 0 747 1 254 1023 63 12000555 8000370 - 0 0 0 0 0 0 0 0 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Ví dụ 1
2d1f518956cdc4b3cf6a9447714cfcd0:94,2d1f518956cdc4b3cf6a9447714cfcd0,94,95,,,108,62 / 107 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Ví dụ 2
2d1f518956cdc4b3cf6a9447714cfcd0:95,2d1f518956cdc4b3cf6a9447714cfcd0,95,96,,,592,"MBR MBR l Khi trường nhận diện có giá trị 05 hoặc 0F, partition tương ứng là partition mở rộng l Partition mở rộng được tổ chức như một đĩa cứng vật lý l Sector đầu tiên là MBR, chứa thông tin về các phân vùng trong partition mở rộng này l Các phần tử trong partition mở rộng có thể là partition rộng l Cho phép tạo hơn 4 ổ đĩa logic 80 07 00 0B 00 0F Sys#Sector Act Size 00 0B 00 05 Sys#Sector Act Size Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Bảng phân chương mở rộng Bảng phân chương mở rộng Bảng phân chương Phân vùng 1 Phân vùng mở rộng"
2d1f518956cdc4b3cf6a9447714cfcd0:96,2d1f518956cdc4b3cf6a9447714cfcd0,96,97,,,136,64 / 107 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Ví dụ về bảng phân chương mở rộng 1
2d1f518956cdc4b3cf6a9447714cfcd0:97,2d1f518956cdc4b3cf6a9447714cfcd0,97,98,,,136,65 / 107 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Ví dụ về bảng phân chương mở rộng 2
2d1f518956cdc4b3cf6a9447714cfcd0:98,2d1f518956cdc4b3cf6a9447714cfcd0,98,99,,,136,66 / 107 Chương 4: Quản lý hệ thống file 3. Tổ chức thông tin trên đĩa từ 3.2.Cấu trúc logic của đĩa Ví dụ về bảng phân chương mở rộng 3
2d1f518956cdc4b3cf6a9447714cfcd0:99,2d1f518956cdc4b3cf6a9447714cfcd0,99,100,,,113,①Hệ thống file ②Cài đặt hệ thống file ③Tổ chức thông tin trên đĩa từ ④Hệ thống FAT Chương 4 Quản lý hệ thống file
2d1f518956cdc4b3cf6a9447714cfcd0:100,2d1f518956cdc4b3cf6a9447714cfcd0,100,101,,,568,"Chương 4: Quản lý hệ thống file 4. Hệ thống FAT Các hệ thống file Tồn tại nhiều hệ thống file khác nhau l Hệ thống FAT l FAT 12/ FAT16 dùng cho MSDOS l FAT32 dùng từ WIN98 l 12/16/32: Số bit dùng để định danh cluster l Hệ thống NTFS l Sử dụng trong WINNT, WIN2000 l Dùng 64 bit để xác định một cluster l Ưu việt hơn FAT trong bảo mật, mã hóa, nén dữ liệu,... l Hệ thống EXT3 l Sử dụng trong Linux l Hệ thống CDFS l Hệ thống quản lý file trong CDROM l Hạn chế về độ sâu cây thư mục và kích thước tên l Hệ thốngs UDF l Phát triển từ CDFS cho DVD-ROM, hỗ trợ tên file dài"
2d1f518956cdc4b3cf6a9447714cfcd0:101,2d1f518956cdc4b3cf6a9447714cfcd0,101,102,,,110,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT l Boot sector l Bảng FAT (File Allocation Table) l Thư mục gốc
2d1f518956cdc4b3cf6a9447714cfcd0:102,2d1f518956cdc4b3cf6a9447714cfcd0,102,103,,,366,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT Cấu trúc phân vùng cho FAT FAT12/16 l Số cluster lớn nhất FAT12: 212 − 18; FAT16 : 216 − 18 l K/thước max: FAT12: 32MB; FAT16: 2GB/4GB (32K/64K Cluster) FAT32 l Chỉ dùng 28 bit ⇒ Số cluster lớn nhất 228 − 18 l K/thước max: 2TB/8GB/16TB (8KB/32KB/64KB Cluster) Cấu trúc logic của hệ thống FAT Vùng hệ thống Vùng dữ liệu
2d1f518956cdc4b3cf6a9447714cfcd0:103,2d1f518956cdc4b3cf6a9447714cfcd0,103,104,,,287,Jmp xx Bảng Tham số Chương trình mồi 55AA Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Cấu trúc l Sector đầu tiên của phân vùng l Cấu trúc gồm 3 phần l Bảng tham số đĩa (BPB: Bios Parameter Block) l Chương trình mồi (Boot strap loader) l Chữ ký hệ thống (luôn là 55AA)
2d1f518956cdc4b3cf6a9447714cfcd0:104,2d1f518956cdc4b3cf6a9447714cfcd0,104,105,,,795,"Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Cấu trúc bảng tham số đĩa - Phần chung Stt Ofs Kt Giá trị mẫu Ý nghĩa 1 0 3B EB 3C 90 Nhảy đến đầu chương trình mồi 2 3 8B MSDOS5.0 Tên hệ thống file đã format đĩa 3 11 1W 00 02 K/thước 1 sector, thường là 512 4 13 1B 40 Số sector cho một cluster (32K-Cluster) 5 14 1W 01 00 Số scts đứng trước FAT/Số scts để dành 6 16 1B 02 Số bảng FAT 7 17 1W 00 02 Số phần tử của ROOT. FAT32: 00 00 8 19 1W 00 00 Tổng số sector trên đĩa (< 32M) hoặc 0000 9 21 1B F8 Khuôn dạng đĩa (F8:HD, F0: Đĩa1.44M) 10 22 1W D1 09 Số sector cho một bảng FAT(209) 11 24 1W 3F 00 Số sector cho một rãnh (63) 12 26 1W 40 00 Số đầu đọc ghi (64) 13 28 1DW 3F 00 00 00 Số sector ẩn- Sectors trước volume (63) 14 32 1DW 41 0C 34 00 Tổng số sector trên đĩa (3411009)"
2d1f518956cdc4b3cf6a9447714cfcd0:105,2d1f518956cdc4b3cf6a9447714cfcd0,105,106,,,133,Ví dụ: 73 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Cấu trúc bảng tham số đĩa - Phần dành cho FAT12/FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:106,2d1f518956cdc4b3cf6a9447714cfcd0,106,107,,,104,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:107,2d1f518956cdc4b3cf6a9447714cfcd0,107,108,,,147,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 3 Bytes đầu: Nhảy đến đầu chương trình mồi
2d1f518956cdc4b3cf6a9447714cfcd0:108,2d1f518956cdc4b3cf6a9447714cfcd0,108,109,,,111,Jmp+3C Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:109,2d1f518956cdc4b3cf6a9447714cfcd0,109,110,,,161,OEName: MSDOS5.0 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 8 Bytes Tên hệ thống file đã format đĩa
2d1f518956cdc4b3cf6a9447714cfcd0:110,2d1f518956cdc4b3cf6a9447714cfcd0,110,111,,,151,Kích thước sector: 512 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 1 Word K/thước 1 sector
2d1f518956cdc4b3cf6a9447714cfcd0:111,2d1f518956cdc4b3cf6a9447714cfcd0,111,112,,,153,2 sector cho 1 cluster Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Số sector cho một cluster
2d1f518956cdc4b3cf6a9447714cfcd0:112,2d1f518956cdc4b3cf6a9447714cfcd0,112,113,,,170,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Có 6 sector đứng trước bảng FAT thứ nhất Số sector đứng trước FAT
2d1f518956cdc4b3cf6a9447714cfcd0:113,2d1f518956cdc4b3cf6a9447714cfcd0,113,114,,,117,Có 2 bảngFAT Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:114,2d1f518956cdc4b3cf6a9447714cfcd0,114,115,,,164,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Số phần tử của ROOT Có tối đa 512 phần tử trong thư mục gốc
2d1f518956cdc4b3cf6a9447714cfcd0:115,2d1f518956cdc4b3cf6a9447714cfcd0,115,116,,,144,Đĩa lớn hơn32MB Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Tổng số sector trên đĩa
2d1f518956cdc4b3cf6a9447714cfcd0:116,2d1f518956cdc4b3cf6a9447714cfcd0,116,117,,,136,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Mã nhận diện khuôn dạng đĩa: F8
2d1f518956cdc4b3cf6a9447714cfcd0:117,2d1f518956cdc4b3cf6a9447714cfcd0,117,118,,,135,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Số sector cho một bảng FAT:245
2d1f518956cdc4b3cf6a9447714cfcd0:118,2d1f518956cdc4b3cf6a9447714cfcd0,118,119,,,130,Số sector cho một rãnh:63 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:119,2d1f518956cdc4b3cf6a9447714cfcd0,119,120,,,124,Số đầu đọc ghi: 255 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:120,2d1f518956cdc4b3cf6a9447714cfcd0,120,121,,,121,Số sector ẩn: 63 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:121,2d1f518956cdc4b3cf6a9447714cfcd0,121,122,,,145,Tổng số sector của Volume: 125889(≈64MB) Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:122,2d1f518956cdc4b3cf6a9447714cfcd0,122,123,,,132,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Số hiệu ổ đĩa vật lý: 00 00
2d1f518956cdc4b3cf6a9447714cfcd0:123,2d1f518956cdc4b3cf6a9447714cfcd0,123,124,,,128,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16 Bootsector mở rộng: 29h
2d1f518956cdc4b3cf6a9447714cfcd0:124,2d1f518956cdc4b3cf6a9447714cfcd0,124,125,,,136,Volume serial number: 70D4-EAA6 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:125,2d1f518956cdc4b3cf6a9447714cfcd0,125,126,,,122,Nhãn đĩa: NO NAME Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:126,2d1f518956cdc4b3cf6a9447714cfcd0,126,127,,,120,Kiểu FAT: FAT16 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:127,2d1f518956cdc4b3cf6a9447714cfcd0,127,128,,,133,Bắt đầu của chương trình mồi Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ giải mã bảng tham số đĩa của FAT16
2d1f518956cdc4b3cf6a9447714cfcd0:128,2d1f518956cdc4b3cf6a9447714cfcd0,128,129,,,791,"Stt Ofs Kt Giá tri mẫu Ý nghĩa 15 36 1DW C9 03 00 00 Tổng số sector cho bảng FAT 16 40 1W 00 00 Flags: #FAT chính(Không dùng ) 17 42 1W 00 00 Version: Phiên bản FAT32 (Không dùng ) 18 44 1DW 02 00 00 00 Số hiệu cluster bắt đầu của ROOT 19 48 1W 01 00 #sector chứa File System information 20 50 1W 06 00 Số hiệu sector dùng backup Bootsector 21 52 12B 00 . . . 00 Để dành 22 64 1B 00 Số hiệu ổ đĩa vật lý 0: ổ A; 80h: ổ C 23 65 1B 00 Để dành/Byte cao cho trường #Driver 24 66 1B 29 Boot sector mở rộng. Luôn có giá trị 29h 25 67 1DW 62 0E 18 66 Volumn Serial number 26 71 11B NO NAME Volumn Label: Nhãn đĩa (Ko s/dụng ) 27 82 8B FAT32 Để dành, thường là đoạn text miêu tả dạng FAT Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Cấu trúc bảng tham số đĩa - Phần dành cho FAT32"
2d1f518956cdc4b3cf6a9447714cfcd0:129,2d1f518956cdc4b3cf6a9447714cfcd0,129,130,,,118,76 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Ví dụ Boot sector của một hệ thống dùng FAT32
2d1f518956cdc4b3cf6a9447714cfcd0:130,2d1f518956cdc4b3cf6a9447714cfcd0,130,131,,,121,77 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Kết quả giải mã hệ thống FAT32 bằng chương trình
2d1f518956cdc4b3cf6a9447714cfcd0:131,2d1f518956cdc4b3cf6a9447714cfcd0,131,132,,,638,"Stt Ofs Size Ý nghĩa 1 0 1DW Chữ ký thứ nhất của FSInfo sector. Giá trị các byte theo thứ tự: 52h 52h 61h 41h 2 4 480B Không rõ, thường chứa giá trị 00 3 484 1DW Chữ ký của File System Information Sector. Giá trị các byte theo thứ tự: 72h 72h 41h 61h 4 488 1DW Số cluster tự do. -1 nếu không xác định 5 492 1DW Số hiệu của cluster vừa mới được cung cấp 6 496 12B Để dành 7 508 2B Không xác định, thường bằng 0 8 510 2B Chữ ký Bootsector. Có giá trị 55 AA Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector File System Information Sector l Thường là Sector thứ 2 của Volume l Ngay sau Boot sector (Sector số hiệu 1) l Cấu trúc"
2d1f518956cdc4b3cf6a9447714cfcd0:132,2d1f518956cdc4b3cf6a9447714cfcd0,132,133,,,120,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector File system information sector của một volume dùng FAT32
2d1f518956cdc4b3cf6a9447714cfcd0:133,2d1f518956cdc4b3cf6a9447714cfcd0,133,134,,,120,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector File system information sector của một volume dùng FAT32
2d1f518956cdc4b3cf6a9447714cfcd0:134,2d1f518956cdc4b3cf6a9447714cfcd0,134,135,,,727,Stt Ofs Kt Giá tri mẫu Ý nghĩa Nhảy đến đầu chương trình mồi Tên hệ th6ng file đã format đĩa Bytes perSector Sectors per Cluster (4K-Cluster ) Reserved sectors. Allwayszero Allways 0 (FAT: Số bảng FAT) Allways 0 (FAT: Sốp/tử của ROOT) Not used by NTFS (FAT:K/thước đĩa) Media Type Allway 0 (FAT:Sectors cho FAT) Sector per Track (63 ) Number of Head (255) Hidden sectors (63) 1 0 3B EB 52 90 2 3 8B NTFS 3 11 1W 00 02 4 13 1B 08 5 14 1W 00 00 6 16 1B 00 7 17 1W 00 00 8 19 1W 00 00 9 21 1B F8 10 22 1W 00 00 11 24 1W 3F 00 12 26 1W FF 00 13 28 1DW 3F 00 0000 14 32 1DW 00 00 0000 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Cấu trúc bảng tham số đĩa cho hệ thống NTFS 1 Not used by NTFS (FAT: ∑ sectors %% )
2d1f518956cdc4b3cf6a9447714cfcd0:135,2d1f518956cdc4b3cf6a9447714cfcd0,135,136,,,687,Stt Ofs Kt Giá tri mẫu Ý nghĩa 15 36 1DW 80 00 80 00 Not used by NTFS(FAT:Tổng số sec- tors cho FAT) 16 40 1LCN 2B 92 00 02 Total sectors (LCN:LONGLONG ) 00 00 00 00 (33591851 ) 17 48 1LCN 00 00 0C 00 Logical cluster number for MFT 00 00 00 00 (786432) 18 56 1LCN 22 09 20 00 Logical #cluster for MFT mirroring 00 00 00 00 (2099490 ) 19 64 1DW F6 00 00 00 Clusters per file record segment (246) 20 68 1DW 01 00 00 00 Clusters per index block (1) 21 72 1LCN A6 CA D7 C6 Volume serial number 00 D8 6C 24 246C-D800-C6D7-CAA6 22 80 1DW 00 00 00 00 Checksum 23 84 - Bootstrap loader Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Cấu trúc bảng tham số đĩa cho hệ thống NTFS 2
2d1f518956cdc4b3cf6a9447714cfcd0:136,2d1f518956cdc4b3cf6a9447714cfcd0,136,137,,,107,82 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Boot sectors của một đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:137,2d1f518956cdc4b3cf6a9447714cfcd0,137,138,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:138,2d1f518956cdc4b3cf6a9447714cfcd0,138,139,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:139,2d1f518956cdc4b3cf6a9447714cfcd0,139,140,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:140,2d1f518956cdc4b3cf6a9447714cfcd0,140,141,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:141,2d1f518956cdc4b3cf6a9447714cfcd0,141,142,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:142,2d1f518956cdc4b3cf6a9447714cfcd0,142,143,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:143,2d1f518956cdc4b3cf6a9447714cfcd0,143,144,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:144,2d1f518956cdc4b3cf6a9447714cfcd0,144,145,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:145,2d1f518956cdc4b3cf6a9447714cfcd0,145,146,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:146,2d1f518956cdc4b3cf6a9447714cfcd0,146,147,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:147,2d1f518956cdc4b3cf6a9447714cfcd0,147,148,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:148,2d1f518956cdc4b3cf6a9447714cfcd0,148,149,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:149,2d1f518956cdc4b3cf6a9447714cfcd0,149,150,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:150,2d1f518956cdc4b3cf6a9447714cfcd0,150,151,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:151,2d1f518956cdc4b3cf6a9447714cfcd0,151,152,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:152,2d1f518956cdc4b3cf6a9447714cfcd0,152,153,,,111,83 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.1 Boot sector Giải mã bảng tham số của đĩa dùng NTFS
2d1f518956cdc4b3cf6a9447714cfcd0:153,2d1f518956cdc4b3cf6a9447714cfcd0,153,154,,,110,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT l Boot sector l Bảng FAT (File Allocation Table) l Thư mục gốc
2d1f518956cdc4b3cf6a9447714cfcd0:154,2d1f518956cdc4b3cf6a9447714cfcd0,154,155,,,260,FAT được sử dụng để quản lý các khối nhớ (blocks/clusters) trong vùng dữ liệu của bộ nhớ lưu trữ l Khối nhớ đang sử dụng l Phân phối cho từng file/thư mục l Khối nhớ tự do l Khối nhớ bị hỏng Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Mục đích
2d1f518956cdc4b3cf6a9447714cfcd0:155,2d1f518956cdc4b3cf6a9447714cfcd0,155,156,,,360,"DATA #2 #3 #4 #5 #6 #7 #8 #9 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Phương pháp FAT gồm nhiều phần tử l Mỗi phần tử có thể 12bit, 16bit, 32bit l Mỗi phần tử ứng với 1 khối (cluster) trên vùng dữ liệu l 2 phần tử đầu (0,1) có ý nghĩa đặc biệt l Khuôn dạng đĩa, Bit shutdown, Bit diskerrror l Phần tử thứ 2 ứng với cluster đầu của phần Data"
2d1f518956cdc4b3cf6a9447714cfcd0:156,2d1f518956cdc4b3cf6a9447714cfcd0,156,157,,,645,"FAT[(32)16]12 Ý nghĩa [(0000)0]000h Cluster tương ứng tự do [(0000)0]001h Giá trị không sửdụng [(0000)0]002h →[(0FFF)F]FEFh Cluster đang được sử dụng. Giá trị đóng vai trò con trỏ, trỏ tới cluster tiếp theo củafile [(0FFF)F]FF0h Các giá trị để dành, chưa được sử dụng →[(0FFF)F]FF6h [(0FFF)F]FF7h Đánh dấu cluster tương ứng bị hỏng [(0FFF)F]FF8h→ →[(0FFF)F]FFFh Cluster đang đc sử dụng và là cluster cuối cùng của file (EOC:End Of Cluster chain). Thực tế thường dùng giá trị [(0FFF)F]FFFh Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Cài đặt Mỗi phần tử của bảng FAT mang một giá trị đặc trưng cho tính chất của cluster tương ứng"
2d1f518956cdc4b3cf6a9447714cfcd0:157,2d1f518956cdc4b3cf6a9447714cfcd0,157,158,,,321,Root entry #12 #13 #14 #15 #16 #17 #18 #19 #20 #21 ABC TXT A Time Date 008 Size FAT 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Special values 03 04 05 FFF 00 00 09 10 12 FF7 15 00 00 16 FFF 00 21 FFF #2 #3 #4 #5 #6 #7 #8 #9 #10 #11 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Liên kết các cluster DATA
2d1f518956cdc4b3cf6a9447714cfcd0:158,2d1f518956cdc4b3cf6a9447714cfcd0,158,159,,,321,Root entry values Special 03 04 05 FFF 00 00 09 10 12 FF7 15 00 00 16 FFF 00 21 FFF DATA #2 #3 #4 #5 #6 #7 #8 #9 #10 #11 #12 #13 #14 #15 #16 #17 #18 #19 #20 #21 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Liên kết các cluster ABC TXT A Time Date 008 Size FAT 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
2d1f518956cdc4b3cf6a9447714cfcd0:159,2d1f518956cdc4b3cf6a9447714cfcd0,159,160,,,320,Root entry values Special 03 04 05 FFF 00 00 09 10 12 FF7 15 00 00 16 FFF 00 21FFF DATA #2 #3 #4 #5 #6 #7 #8 #9 #10 #11 #12 #13 #14 #15 #16 #17 #18 #19 #20 #21 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Liên kết các cluster ABC TXT A Time Date 008 Size FAT 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
2d1f518956cdc4b3cf6a9447714cfcd0:160,2d1f518956cdc4b3cf6a9447714cfcd0,160,161,,,320,Root entry values Special 03 04 05 FFF 00 00 09 10 12 FF7 15 00 00 16 FFF 00 21FFF DATA #2 #3 #4 #5 #6 #7 #8 #9 #10 #11 #12 #13 #14 #15 #16 #17 #18 #19 #20 #21 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Liên kết các cluster ABC TXT A Time Date 008 Size FAT 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
2d1f518956cdc4b3cf6a9447714cfcd0:161,2d1f518956cdc4b3cf6a9447714cfcd0,161,162,,,321,Root entry values Special 03 04 05 FFF 00 00 09 10 12 FF7 15 00 00 16 FFF 00 21 FFF DATA #2 #3 #4 #5 #6 #7 #8 #9 #10 #11 #12 #13 #14 #15 #16 #17 #18 #19 #20 #21 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Liên kết các cluster ABC TXT A Time Date 008 Size FAT 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
2d1f518956cdc4b3cf6a9447714cfcd0:162,2d1f518956cdc4b3cf6a9447714cfcd0,162,163,,,620,"Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Ví dụ: Đọc một sector của FAT32 #include <windows.h> #include <stdio.h> int main(int argc, char *argv[]){ HANDLE hDisk; BYTE Buf[512]; DWORD FAT[128]; WORD FATAddr; DWORD byteread, i; hDisk = CreateFile(""\\\\.\\F:"", GENERIC_READ, FILE_SHARE_READ|FILE_SHARE_WRITE, NULL, OPEN_EXISTING,0,NULL); ReadFile(hDisk,Buf,512,&byteread,NULL); memcpy(&FATAddr,&Buf[14],2);//Offset 14 Sector truoc FAT SetFilePointer(hDisk,FATAddr * 512, NULL,FILE_BEGIN); ReadFile(hDisk,FAT,512,&byteread,NULL); for(i=0;i<128;i++) printf("" %08X "",FAT[i]); CloseHandle(hDisk); return 0; }"
2d1f518956cdc4b3cf6a9447714cfcd0:163,2d1f518956cdc4b3cf6a9447714cfcd0,163,164,,,118,A Root entry 90 / 107 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.2 Bảng FAT Ví dụ: Sector đầu của một FAT32 FAT
2d1f518956cdc4b3cf6a9447714cfcd0:164,2d1f518956cdc4b3cf6a9447714cfcd0,164,165,,,110,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT l Boot sector l Bảng FAT (File Allocation Table) l Thư mục gốc
2d1f518956cdc4b3cf6a9447714cfcd0:165,2d1f518956cdc4b3cf6a9447714cfcd0,165,166,,,544,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Cấu trúc thư mục gốc l Bảng gồm các bản ghi file l Mỗi bản ghi có kích thước 32 bytes l Chứa các thông tin liên quan tới một file/thư mục/ nhãn đĩa l Hệ thống FAT12/FAT16 l Thư mục gốc nằm ngay sau các bảng FAT l Kích thước = Số phần tử tối đa trong thư mục gốc * 32 l Hệ thống FAT32 l Vị trí được xác định dựa vào BPB l Trường 18: Số hiệu cluster đầu của ROOT l Kích thước không xác định l Hỗ trợ tên file dài (LFN: Long File Name) l Một file có thể sử dụng nhiều hơn một phần tử
2d1f518956cdc4b3cf6a9447714cfcd0:166,2d1f518956cdc4b3cf6a9447714cfcd0,166,167,,,682,"Stt Ofs Size Ý nghĩa 1 0 8B Tên file 2 8 3B Phần mở rộng 3 11 1B Thuộc tính của file 4 12 10B Không dùng với FAT12/FAT16. Sử dụng với FAT32 4.1 12 1B Để dành 4.2 13 1B Thời điểm tạo file, theo đơn vị 10ms 4.3 14 1W Thời điểm tạo file (giờ - phút - giây ) 4.4 16 1W Ngày tạo file (tạo bởi ứng dụng hoặc bởi copy sang) 4.5 18 1W Ngày truy nhập cu6i 4.6 20 1W Số hiệu cluster bắt đầu của file(FAT32: Phần cao) 5 22 1W Thời gian cập nhật cuối cùng 6 24 1W Ngày cập nhật cuối (không y/cầu sau ngày tạo file) 7 26 1W Số hiệu cluster bắt đầu của file (FAT32: Phần thấp) 8 28 1DW Kích thước tính bằng byte Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Cấu trúc một phần tử"
2d1f518956cdc4b3cf6a9447714cfcd0:167,2d1f518956cdc4b3cf6a9447714cfcd0,167,168,,,958,"Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Cấu trúc một phần tử :Tên file l Chuỗi ASCII chứa tên file. Các ký tự là chữ in l Không chấp nhận khoảng trống ở giữa l Các câu lệnh copy, del,... không nhận biết tên có dấu trắng l Nếu ít hơn 8 ký tự, được chèn các ký tự trống cho đủ 8 l Ký tự đầu có thể mang ý nghĩa đặc biệt l 00h: Phần tử đầu tiên của phần chưa dùng đến l E5h (ký tự ""δ""): File tương ứng với phần tử này đã bị xóa. l 2Eh (ký tự "".""): Đây là thư mục con l Trường số hiệu cluster bắt đầu chỉ đến chính nó l Cấu trúc như thư mục con giống như thư mục gốc: gồm các phần tử 32bytes l 2Eh2Eh (ký tự ""..""): Đây là thư mục cha của thư mục hiện tại l Trường số hiệu cluster bắt đầu chỉ đến thư mục cha l Nếu cha là gốc, #cluster bắt đầu bằng zero (FAT12/16) l Thư mục con nằm trên phần Data, được quản lý như một file ⇒ File của các bản ghi file l FAT12/16: Thư mục gốc ở vị trí xác định; FAT32: Thư mục gốc cũng nằm trong phần data"
2d1f518956cdc4b3cf6a9447714cfcd0:168,2d1f518956cdc4b3cf6a9447714cfcd0,168,169,,,260,Name DATA A Clst V 00 Sub-1 D File-A A Sub-2 D ROOT D ... File-F A D Sub-11 D File-B A Sub-directory F F F F .Sub-directory F D D .. File-E A F . D .. D File-C A A File-D Sub-directory Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Thư mục con
2d1f518956cdc4b3cf6a9447714cfcd0:169,2d1f518956cdc4b3cf6a9447714cfcd0,169,170,,,320,Name DATA A Clst V 00 Sub-1 D File-A A Sub-2 D ROOT . D .. D F ry File-F A Sub-directo Sub-11 D File-B A Sub-directory . D .. D File-E A F F . D .. D File-C A F F F DATA Sub-1 File-F Sub-11 File-C File-D File-B File-A Sub-2 File-E Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Thư mục con Sub-directory
2d1f518956cdc4b3cf6a9447714cfcd0:170,2d1f518956cdc4b3cf6a9447714cfcd0,170,171,,,314,Ví dụ: Byte thuộc tính 0Fh: 0 0 0 0 1 1 1 1 ⇒ Có các thuộc tính Volume label+System+Hidden+Readonly Ghi chú: Giá tri byte thuộc tính 0x0F không sử dụng trong MS-DOS ⇒ Dùng để đánh dấu là phần tử Long File Name Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Cấu trúc một phần tử : Trường thuộc tính
2d1f518956cdc4b3cf6a9447714cfcd0:171,2d1f518956cdc4b3cf6a9447714cfcd0,171,172,,,163,0 1 1 1 1 1 0 0 0 1 0 1 0 1 1 0 Ví dụ: 15 giờ 34 phút 45 giây Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Cấu trúc một phần tử Có giá trị :7C56
2d1f518956cdc4b3cf6a9447714cfcd0:172,2d1f518956cdc4b3cf6a9447714cfcd0,172,173,,,147,Ví dụ: 17 tháng 5 năm2011 Có giá trị :3EB1 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Cấu trúc một phần tử : Trường ngày tháng
2d1f518956cdc4b3cf6a9447714cfcd0:173,2d1f518956cdc4b3cf6a9447714cfcd0,173,174,,,507,"... Phần tử LFN 3 Phần tử LFN 2 Phần tử LFN 1 Phần tử 8.3 (ttt∼n.xxx) Ofs Kt Ý nghĩa 0 1B Trưong thứ tự. 1 5W 5 ký tự unicode đầu tiên 11 1B Thuộc tính. Đánh dấu là phần tử LFN. Luôn có giá trị 0Fh 12 1B Để dành (00) 13 1B Checksum: Cho phép kiểm tra tên file dài có ứng với tên file 8.3? 14 6W Các ký tự unicode 6,7,8,9,10,11 26 1W Số hiệu cluster. Không dùng (0000) 28 1W Ký tự unicode 12 30 1W Ký tự unicode 13 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Hệ thống Long File Name (LFN)"
2d1f518956cdc4b3cf6a9447714cfcd0:174,2d1f518956cdc4b3cf6a9447714cfcd0,174,175,,,616,"Entry Ord Attr Data LFN 3 0x43 0x0F ame.docx LFN 2 0x02 0x0F y long file n LFN 1 0x01 0x0F This is a ver 8.3 Name THISIS∼1.DOC Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Hệ thống Long File Name: Trường thứ tự l Cho biết trật tự các phần tử LFN l Mỗi phần tử LFN chứa 13 ký tự Unicode l Phần tử đầu tiên có giá trị trường thứ tự bằng 1 l Phần tử cuối sẽ dùng bít số 6 để đánh dấu l Chỉ dùng tối đa 20 phần tử l Sau ký tự cuối cùng là 0x00 0x00. l Các ký tự không sử dụng có giá trị 0xFF 0xFF l Bít số 7 (0x80) cho biết phần tử tương ứng đã bị xóa l Ví dụ file ""This is a very long file name.docx"""
2d1f518956cdc4b3cf6a9447714cfcd0:175,2d1f518956cdc4b3cf6a9447714cfcd0,175,176,,,90,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Ví dụ: Một sector của ROOT
2d1f518956cdc4b3cf6a9447714cfcd0:176,2d1f518956cdc4b3cf6a9447714cfcd0,176,177,,,88,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Ví dụ: Nội dụng của ROOT
2d1f518956cdc4b3cf6a9447714cfcd0:177,2d1f518956cdc4b3cf6a9447714cfcd0,177,178,,,76,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT
2d1f518956cdc4b3cf6a9447714cfcd0:178,2d1f518956cdc4b3cf6a9447714cfcd0,178,179,,,114,DATA Nhãn đĩa #Cluster : 0 Size : 0 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 1
2d1f518956cdc4b3cf6a9447714cfcd0:179,2d1f518956cdc4b3cf6a9447714cfcd0,179,180,,,127,DATA Nhãn đĩa #Cluster : 0 Size : 0 File đã bi xóa Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT
2d1f518956cdc4b3cf6a9447714cfcd0:180,2d1f518956cdc4b3cf6a9447714cfcd0,180,181,,,93,File ReadMBR.C Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2
2d1f518956cdc4b3cf6a9447714cfcd0:181,2d1f518956cdc4b3cf6a9447714cfcd0,181,182,,,111,File ReadMBR.C Tên file: READMBR Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2
2d1f518956cdc4b3cf6a9447714cfcd0:182,2d1f518956cdc4b3cf6a9447714cfcd0,182,183,,,121,File ReadMBR.C Tên file: READMBR Mở rộng:C Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2
2d1f518956cdc4b3cf6a9447714cfcd0:183,2d1f518956cdc4b3cf6a9447714cfcd0,183,184,,,129,File ReadMBR.C Tên file: READMBR Mở rộng:C Lưu trữ Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2
2d1f518956cdc4b3cf6a9447714cfcd0:184,2d1f518956cdc4b3cf6a9447714cfcd0,184,185,,,135,File ReadMBR.C Tên file: READMBR Mở rộng:C Lưu trữ 600ms Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2
2d1f518956cdc4b3cf6a9447714cfcd0:185,2d1f518956cdc4b3cf6a9447714cfcd0,185,186,,,157,File ReadMBR.C Tên file: READMBR Mở rộng:C Lưu trữ 600ms Create time 11h28m12s Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2
2d1f518956cdc4b3cf6a9447714cfcd0:186,2d1f518956cdc4b3cf6a9447714cfcd0,186,187,,,180,File ReadMBR.C Tên file: READMBR Create date 05/05/2011 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2 Mở rộng:C Lưu trữ 600ms Create time 11h28m12s
2d1f518956cdc4b3cf6a9447714cfcd0:187,2d1f518956cdc4b3cf6a9447714cfcd0,187,188,,,203,File ReadMBR.C Tên file: READMBR Create date 05/05/2011 Last access 05/05/2011 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2 Mở rộng:C Lưu trữ 600ms Create time 11h28m12s
2d1f518956cdc4b3cf6a9447714cfcd0:188,2d1f518956cdc4b3cf6a9447714cfcd0,188,189,,,227,File ReadMBR.C Tên file: READMBR Create date 05/05/2011 Last access 05/05/2011 Modified time 15h14m30s Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2 Mở rộng:C Lưu trữ 600ms Create time 11h28m12s
2d1f518956cdc4b3cf6a9447714cfcd0:189,2d1f518956cdc4b3cf6a9447714cfcd0,189,190,,,252,File ReadMBR.C Tên file: READMBR Create date 05/05/2011 Last access 05/05/2011 Modified time 15h14m30s Modified date 04/05/2011 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2 Mở rộng:C Lưu trữ 600ms Create time 11h28m12s
2d1f518956cdc4b3cf6a9447714cfcd0:190,2d1f518956cdc4b3cf6a9447714cfcd0,190,191,,,272,File ReadMBR.C Tên file: READMBR Create date 05/05/2011 Last access 05/05/2011 Modified time 15h14m30s Modified date 04/05/2011 First cluster 11840 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2 Mở rộng:C Lưu trữ 600ms Create time 11h28m12s
2d1f518956cdc4b3cf6a9447714cfcd0:191,2d1f518956cdc4b3cf6a9447714cfcd0,191,192,,,288,File ReadMBR.C Tên file: READMBR Create date 05/05/2011 Last access 05/05/2011 Modified time 15h14m30s Modified date 04/05/2011 First cluster 11840 File size :2749 Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 2 Mở rộng:C Lưu trữ 600ms Create time 11h28m12s
2d1f518956cdc4b3cf6a9447714cfcd0:192,2d1f518956cdc4b3cf6a9447714cfcd0,192,193,,,78,Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 3
2d1f518956cdc4b3cf6a9447714cfcd0:193,2d1f518956cdc4b3cf6a9447714cfcd0,193,194,,,222,Phần tử LFN# 1(ReadBiosSecto) Phần tử LFN#2 - LFN cuối (r.c ) Ký tự sau ký tự cuối (0x0000) Phần tử 8.3thường READBI∼1.C Chương 4: Quản lý hệ thống file 4. Hệ thống FAT 4.3 Thư mục gốc Giải mã ROOT 3 File: ReadBiosSector.c
2d1f518956cdc4b3cf6a9447714cfcd0:194,2d1f518956cdc4b3cf6a9447714cfcd0,194,195,,,367,4 Chương 4: Quản lý hệ thống file Kết luận ① Hệ thống file ① Khái niệm file ② Cấu trúc thư mục ② Cài đặt hệ thống file ① Cài đặt thư mục ② Các phương pháp phân phối vùng lưu trữ ③ Quản lý vùng lưu trữ tự do ③ Tổ chức thông tin trên đĩa từ ① Cấu trúc vật lý của đĩa ② Cấu trúc logic của đĩa ④ Hệ thống FAT ① Boot sector ② Bảng FAT (File Allocation Table) ③ Thư mục gốc
